[default]
host = <%= node['ec2']['instance_id'] %>-splunk

[monitor://$SPLUNK_HOME/var/log/splunk]

[monitor:///var/log]
ignoreOlderThan = 30d
disabled = 0
index = default
crcSalt = <SOURCE>

<% if node['splunk']['ssl_forwarding'] == true -%>
[SSL]
password = <% if node['splunk']['inputSSLPass'] != nil -%><%= node['splunk']['inputSSLPass']%><% else -%><%= node['splunk']['ssl_forwarding_pass'] %><% end -%>
requireClientCert = false
rootCA = <%= node['splunk']['server_home']%>/etc/auth/forwarders/<%= node['splunk']['ssl_forwarding_cacert'] %>
serverCert = <%= node['splunk']['server_home']%>/etc/auth/forwarders/<%= node['splunk']['ssl_forwarding_servercert'] %>

[splunktcp-ssl:9997]
compressed = true
<% else -%>
[splunktcp:9997]
compressed = true
<% end -%>